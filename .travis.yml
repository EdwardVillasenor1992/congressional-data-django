language: python
virtualenv:
  system_site_packages: false
python:
- 3.6
services:
- postgresql
env:
  matrix:
  - DJANGO_SETTINGS_MODULE=congressionaldata.settings.local
  global:
  - secure: hL7u0VgC7NZT3bmzy1pu9hBHuM3M8jB7npBq6tLVsv8vwVLXlWWByBWSkKlSAQkS2nnPZT5TpJygA7WEO2imNmTzYDjaKgrBipBuB938DBzntY+UVrM9Vxywf0n3kN1aph06mueW/FlZ6C08m+TrS34ydTD9cJwxFb5FJ3sxYStlO7PRh08gWHuO3NKz44WmrMBs8i4IHV+MzJpKMIjiPktEiz1+R957uRM5mNftuAhV0zFyla2sp6oEQbWMBaLrUzCnfIVqdTcsyJm2o+NhqYnqLX2TJ/TSI6tLzxHfjxKjbff19oBFt5TR7AQYuCj5avV8ul+kzPH6NjTxrp2leE8bnC4Qiocp01yvJr+canCaC8SdCCFGnUD+MRQnRORs8xx/Oy9Hk+hoWD37MrcnFbCgP+PadaCF9MR1lEgL4WrPXnQ1dXHUBsTJFYjRO9Fi9HUYSRlXOUHd1JaWs8KgLL348Te4FtW/g3GWXx0yHAA7ltw31YTrrR+QCHsbiyo9468C+U51eh55NPx+iLoe8avsrIKFGoWvtSMVxHhu5NzIu9WTxIxyOPP40+xR5Eq8YKvVV6vKTjMnQ/l90ZTbsGsBy6C4gxLnElUBAnvY8UILx9zj/aTHvIOVCjdQn4gsqiBcd70gBRj2pAW018r3wA5dQ3JoD6KGQSJK/mc6Juo=
  - secure: Rcrv2xtpxj7MNU6vspO8Eb+ed6ZYA7fKPGvIkaAcDwO9gf7qqKVdyoL8Kqx5BIRWuG/0ViMoBpMhfwFLRo8J1D1JVugD/G2/VePe4zVdSAEYaZISzaCFf5L+TIssd6g5sf3NN9B8jciaDm8lTRpe/mAmiqThF9K3ByMx02M6vi49WvSXXC8uR0wBxZroOVYdhP+Sqk3o25TQFyLHz1ON53ZBdMZg7eGUqM+nQ2SC18gBz+sJl5xbpFQONv0Rnd0Cr2DraCCr2LRXQccbVqN+9J06IXfXuOKwtBWwCuPOSCGnMmOuBsTSrfKU+M2oAtCV4rncoxKgranZJuXUYAvER139u6jqo3BH3oeO5OvlFoRNy8b/C3aXdD1DiCymKQTh0mmVz8UB1s0kE0IGlPZCAyMPhozCI2l7aHJq1zogVZ1TeJXmjgdvy39oWfvhBanjpuztB+f17RWXhJNkKl4EWv7HRAqKsfGBus5ZodRUlRaiDKd/SBZ3kjhAL2O9IrQJUQPdthTlHAmSHmN+ykFzipopDLZM0eVX7caM2KflUA17mZn4w3jRkgNZ93qhRaryYp5L+Humr3tdCnoXbDxcn5oH5d2AUuRarBdJ/2sSglpoF5HTfiBeQtTxNfjA1VBXocc+yR2iXMCeSWNXFVYpsz+HEeF9vBn+JZQBmElgqW4=
  - secure: e3Fhk3M9UcmUNrlCtKTe0UQswsyJxNtqgOGRO4lWyH18tx6cLiA3gaz96SJYHdjQK8kiTAjVvHmmGDCpY2jRxDQXOVBgBwnFF3e9MeRYrPShRM0MpbFXnJzF6zIcTr84Mg5BcNRuDYa6ZZ8lVcb4XvgWaWs/4S/X+/qr67Dym8/X+U8tXnL/Hpl81zudj0WfjrA/nIJfRS0W6KeOAtM+BQShw1NSejcs8NcMIdyiVd6G9ikCfRPijJ0mZMKFLw3taHARh3NE/pyKaFpwp/riyZoXGDMIqNT1BOBY8ZMpSQkHaK6/QIn5ap0EMa8Vyg68ej/6/PPYg9V3h2S0TChJHk0r835/I4W7wKu3V+Be7O6R1kYWZQX4AK8JNHi39jqe1KLRc+tmi1Z8M8Sp9sx852zUhhrPexFQVSvbxYlVgMuX0FF4u53nRtLQDrsmVrQtaWpNEPIwFJVgGJd++WpcETtKlDxhgZRY6974AsuJ/9pfyPOeUPuPuHQ7u0DbWOWR2ewlGe2UacNBVT9df2VUeY2xZ+E/7JFOMIsAxzc1ppnUKKPVWZdq0dCaX5EQaqX4TxXc6FKiQsdHd4Fcn2UOmbXdpjLBfFd1TkqPkWHJ78Br3brp0RLg38RnaEJrSS3JkG7LGpRpf54PY8TiI6sK0/cYDM8Y28griia4vKNw50Y=
  - secure: Ab98+1XzjOOMi0ehFaCG19R+nA7FN6E8RgFNfB9JNac+2v5hcRjlVd9pjw22gSgDIzODFbfXYU/nstURMlQhUJafsYhH79137Q7EhkC113lCQEMrAgYxAvHd3g1LvKUq8DituTWYjQe0oEWvqWslMFu1+CjvUmS3QiirnXzReIKS1iVOm6gD+BOfCR6mQeE1FtxRuaEyjUYoFX+WAnvDs2rh34DhNN9g36HcYFgSEQYM2g2j+cE8isBm6Swa2XL+0LaYSpzVie+o0RxVzu9Mj8uJCe9F/zRWVbdkbpLgSuB52hz7D0hsJo4QiHMgWkgN4TTanmvEOoMi0higV8jQTOdHyiM+jf+AWeRx4yc4ZaNcMaIUiA7GhuzIfsnPOxEQH08khP1XJODp9G9IZw182p8SVtg1GYVQBj81dl8veslF+6aOM7AxJK2PnVF+VQJhc9qmbteIyAq3YGSHtIw/j02BN8JgzjyOEXMEp41KqYzjpS2jKCahAY+nAuOudmiB0vs7QvOBoacJzRcs13tWKOf7tBUX2t3PXBjGVM85k4TFiETZ/jfsePn0ATCjzpILWDEW+ECinL+AD4wh0dlMnne49QJItdPIJSnxxoNc3oawmdQblVIXMthllO4+HSt/X4yPEtpeoATBVRDUOJTVa3/u9t6AOoYjQCZeILW9nvo=
  - secure: gc9Z8R/7zYE4tVgiWhFO5YY/fw/j2E9/3+Gxcjm+007SwE3AZpurk/6tMnQj6APVNqI7q676t6qATNyOaZ3IbQWoXMb4qXKLOlWA0KjOvPgW8h+klRHbtSMwPxRvaz9wlskIWgXYkhRHpzgVuSjz8E+GvC3LbH7Dg98CLRPClM9IiDLi1CDg8BbqJWBqvxuI9DZ+8CvgjEqL9CG18DfYN1aBZBao/IFPpp5okrlOX+ikZeIM+D5u4KmGSXwOuY0RpKgjU3hiYyFik/kVm/EpgUoTiR/fPLRWNXEJNj5jLZ5nDC3JK1Fip9wrC1PydRW3PWq5sjLYJzQ3ZFd2zIN0oUdGs9YHqPxyTO/jBAkrrCvRWRZPko7c+tAjIOhTIDEPFyZdmEck5yhXHeQs3N0NqIJKqCkBDyrkoaDpdiMP7rL26Z2ly1e0WC3/xktv/SNnuBaC3kr5rTBYMBsvcE1LNndwXZ2mlkuLwXyU0gOW9TB7vBk/+oU9J9IkNqeA42Kx2cHRf+QHOEDDFa9xqJQ5cLS7R6MpbnIFuvj+ox1nxWL2hJoZkgkt7SLWFhpM0UNstR9Dc5csOdM++wPSw6j+Tr+gz8KQyaqVAcfY7BkUq1dWdU51PQjn6yJEGvTre8bJA3xmCisljMeIfSyOcJZXNED27WV4xY0+oaaXTlcHHFY=
  - secure: Uo9vmoEUljfhqJS+KguproB/yYMFwscGPaSQVaSIUhjoCid7SVPMzBdt9lNBHpzYKY4jTiQDumQUeo1B3lKN8uTs+C5aCopAsFwvv5vEdKBTtHF/guua5PbkvQ+4QPpnpWni2iR/4yURv2Ksmfku1BujP7HwzStlU2oeWUkzWVQsENoAtnUQBjfvBsQyLyqHTIfXseEAJZcCQue6zFOJoTvcEU5cBbhl/tcoIUKu7YhB1OsXUUboZgpZnz6l9B/7fcDSpB7F+nS16x80hi49BebDkbR1q4M/SxU5kzzz+sBpLhqMpYy/w5+X5IcjuG/QNKf82uZwXBKlLrfHSWKJ0oxOY/CEmGca/IArKOSG42Mpcr6N0VfuEblnxT8zTmkSSC2TN/KfYvmajLqmGFGgFAMT1FcCUmW48Fc/hJYH0HVYUedzCSBXHVZiwy++hPT7l4WQVWkO4E7jSJmwAOuY5ldFlcd1bsZPhROMo65c0613RZzvL8JQ6F1cpl7ehpSFfuVxZxCZgpBTXIo6E54Y9kZq2DyQHKWTnNAL1KUjj+hA2UI6Zcjxh77arz8tOYY7r7HYqGmxgiN7sOb6z7CF99MZjCfRrs2CLanRexYVXeAmQrpHegGQlP33siYYJi+H8ASYbtG3Jqb/ukrWEiC0OTsJE41d0B+V0YzIXgDKS8Y=
  - secure: RMNdlzKrK9s3z+IbuT7cHnZVK6VHYA9QGyOa1LJcsBK8uYQGrEPMeVlPyzWuaGs6yb17bjeO+knHiuDXIUBuNlWhAb0rqk+Aon1k/gQ+9ZsUeaFGkcZa/u3wvJtzsQqsyxmkxfWjD2s2CkBk8wAE0LYmGDILVEO1TOIGvbHdSiTbGjzp72DCQ+ctLCm7FuYWGC67vnwZFjmiTF+7NMcBIzA1t1398JpMin1k/lWKsOUsL5pQLcNKOyjcIiJXTG2gK4/q8mJUqMbiAIYXgKmVQz7w1cOPB+aLHLJBr4PSQFNSOBPdelSkE1mS5tJRMuTqW5XRzCBWD0RSkrwuXSNBy14aSLLI+WHwD/Lo77wmy0m49Lsp+iEAjVnSzOpFgGdwLB6kzl7s0MWgALUo6io2sVgxRt3Kws5UwSWYDgfyOw9GlXTeHIedKSe2xIof27yJVweD0pBTJ8Xzr63Ycics5AnR4qSD7fj71rBCQ50+X/NhPeKU8RaOIIY2hDG12IGrpx+xK0uhp6MdPAFQc+bcspzZCTVwA8M+EZpbbFZ9wmjUQzn9AAjEsu7fTrKDQKTbPGa6i6jVkjk/PMCbQ9LwU/zNepNvf9V8lfffLX8J6fUZdRbuf/aHuCrkVOyU8r+LBS8cgi02gqVB0BL660Uydeomh1SeE8hxZxlXA6wOlCk=
  - secure: hOBxiIjtX1FUn/MgUKiiOXPA8roKlqkFVHPh0LWMU2cxqCmSXYUORN53U4Gymq6847TDwLKCRX0rRBAKm4R8WSxDEKB5dOKEkwfvesRdlauofqef2UbMkW1uLpEC92HEqs+vU5+S8W/HDALF5yJJWyCbzrEq4mCh387oQ3IWb+LybIUqZpInB1eCpBkoA27TpMW4YlRGfl6cPzmGOWOXBAAiQ1XQlsUcoNbfpHzPff58sZqOX+Lu1ClvEhfm7bMLnQ2VSzRU18HakLbtWNQI7feAoURKtQpmxLT5wnQIyAnvJkRuZbs3H2demGGHS7yetpVurhKkCztpEypmVhiszGrpSdgk5cz3WgSCrBRJ9grSjgQlPE/R2KW8MM0YMLNJzo3fp12tSLiyj+29xzmyHDMOMPHu9Yj2sPiC4q9iuwu68sowDnQSMWmJyyoZGY7Zr8UNT3aicJDiJDlt2T0DPGyv1BOKDZbj1+V4k2vdy3RF+CIqipnLKt69SH6ZO0nE9qJbw+tUqc6ZII3yF2PK1eE8y3kKTwzgSFtMG6D2inZ85I3d7mwqaRhjoKrlPE9eHcQ7/5iggnMWcV95FcOVVYYUJC4JsBSA+erN7ZOThNgLpbMSYgIk/wwvmJ9Hu5bNqjB8pPHpFkTDn5M+xbNumq+0BqnQKVUxwj8VJ3YiAPk=
  - secure: xvq+wbPpV1+M/UKpnDAgVZTdqqKzRkm6cVfYGjvzzwH3KvSJuc3z+zwIATdVyahaUOwFvgHxlP9zDaafWwgAGap8OILP3Bf2VhWzQe6VxhYLsT67X3xmlJAjKR0X3OEo/ZKPhEua204494Jt1jKJ8k9oNrLHK0esxd5cIVJG628iOpA3/z0xxaSd9hIhsUr4m/4zzTyvBy6jAdWgTXRfL5vKZFMw/PMbaCKuN8bstzOSYE31sLjuPvMy7I2WBIjjFAeYz6uXazeAHghuLvI2wB76nddRgMCGGbmKnFjG0wRLmHdoRh0gXQzUu+wtK2zKtPfVHCgUGIXtIMKkVAHHCV5AqQ3uqalGwE8bTJwXyypJvkjRk7gCSPXNDL8F3noKjL8yGVMz74xY+2H6YCIupYKMClr+Z50/24F+MOSllJztDuw6GoQpikypr51zyATt9NUgAFudWUb4YZhvUSpF9jKA7fDdqOc1CEgNk79nKzk7222N02+6h4N2+HgWNlY+Bkq6TovA7INNui9pU8sWjn3LBcmRDYyU1avTx6VajCQZ1ROi8hg2u/F4jvsjVSs+HmFNCeXDp9SX8rnbB4E81l9N5hr7HwWOzc3NfK8Lo+AJOibJV7L1MHkJzTtdpD/EflrogpEowswYAsy7oKQU+qiOjwqYrknb/p34o4G40Vg=
  - secure: WuIkekoVqAihjnIqC1t6/XC/3VMa9HFq+rHI8wO92KbaPYOKax7nSPsZyc6sCGRKeAjtkeH+J4qARdQEXG80nHKq2wtkeAmnvyz0AoTyAIAkeL9fx0q9jXQnuubzvtcBk7hSnnGtV0OrS+T3r4ngkjWzfMWkox5A8vwpfyca6Yc/5T7yGxJlOTcA8Trp8oSlEp5KWoCL6I8qF9QELm7RuTBzJ+0s7E2arU2VNC/IjyFJKptfC4XjqudTeXd4uCLHA8hf7P8QoUTuiJe5vCPbJOEWlie5s0QRrk+VKVwun5HvGbnY0pwPtyfFCGcUj3+OOGJx5IDxyXEd/Wr/X/CjSVR2UhQ5E8Q7iY/T1Hxm2+cs9x5RUlDtuHwAOd8amoUBqoMwzQsGJ6hW6iCdaTLwQtacm4vu0OJEP2U+URidNqeB9g7/ZPTcXepr3SrCvKWvA2Iw6MOUhjsuhZqzR+CullqZZsRtT0BFL0R3pxASiKs25LgD+8qxt02DzQFww5JOjY1E+uu5k3CPE9iLLtFX0pB0PlWsTZKTXPQ3aBfFyS0B8syyIIl7VCuVSpQk/JKuDT0xTdtXILI2+2OLr7a1RvsAwd+Nk6XKEdL8BH37FmtOG7mdjZkpvvUu74fzsP7NAaUW9weiG9BvseTe+l8XJC9lyDu4lC5a/E0jOzfrYMU=
  - secure: igKuVJ7ME/3btKLNVVpCLqVHrR3GoD78lGtxG6+yhjD1HjfYZPHXKPeu68ClDXpRP/4SlhfNEmfydGitZClcAVP41XIgubCj/S+wVoDMJwmL6SKadYydjX8Ia72LNA4L2M34733NWAxd9241GPOCEZk/rixrtEU4tMRLt6Tz/OVriumkKDfis0TKuX/6hvwbFkxT2gfJGvrv+kc3o9xGnFGx9cYhiitgzWZBA9GUL4A1uRD5bQoBCQvK1X7d+Rc+LhXxObySLq/cgi4u65ZyEtbgifmzlX+Df1VCJS3CYhiyVOvmYG8eHDRc2lXXe+6ZVl8epSwz0IPF7hDIYiaQSEzKw71ciGoeHZEGEiwJgqnPQvEm27WRnn95nZp4E1gd7uuQzTGElLpBnOEGnWbBi35v8t4kLJDeGr+somcMdZge4hJqj0hO5u0Utf/nklMfHL8Qh/ZqqDl6FRmM5Ph3Gp+7W/9IdoyxVH91CEuYacP0rLEH8EETYRE/CydQOVD/tGeMcxU/7D3Oz2pvd7j8MARxi0bmlTFrP6KWi01kYZtt6EFr1gvmWD8CsaKNudfMpnDAX/zxDkG0uexLXKMtMjG8RXeGLibyq7WOfET6El9/5gLfXWZvsPWtSvzhi7HbDX0znqRhrHtdTHrVakiM0jFIoZM5fwVV7+bX1yuDUDk=
  - secure: c4DlAfY9mu5Lkyb58Z8feMYQkXunGG5s/aexqnu203IRW6rBNgHG5Zw5iN4gb5F7v/1KZr3UARJXYUtaSfg6iqRalbObIuszf+1INEZQBSdGgG7HuVXKs1U13dF1wrD3MgSk8fqoj02GUTap9qDfall0GzNKDJmJqH+gRhUUg2MtIfMG7B6jzrW2bJOoqetnxE1yl48CSOUoXebTvkd/a3kAthOmnyXYqu2dBZpL26HRNUVmNpdmNKfw1ewHSNk8BVK2CaI97yONv4bETV9c/5DbanP2zFqeej9SLc4YZ8cHEE5d7jgvj1V2cz8MvhIkYzB9DmiR4izbGStifdVBNoWiKJUYexvanlhQq0NkkFVAekyFnODgIBhSdCwakS5RBZkG4Hp/EUoNHe+o4zjjVmoHQ+a5GKT8g5R3VZHQXwHi9pghPKokCOIZakpt5q3lCC5gTbnk5aluIA3Ys79DvFQi8D9YNaPqretQDnjFfwLdQp9xJ6YQ7Fjn1yg3SIlzEsEKVp+gGTun+emusaAVHEUvRWhV+8T2QOmUPa6T+SdfJv6LwvcstrwNUnUur/zD+5Vkc4oggepFlRFgrY8AWLlQ0gyy1VsCpzu4oHcnuOmcYqXPErGtb91OZHifoLKeiY+3ZlrFk+qk7xmL+nziuYllnmDBPSbIh9Q8pjefDcw=
  - secure: JcaGqkdl7aPu2WeEwWhQvPPs1doOhutUe3CE4fKv+h3NOdzagzxgA8uiZc8dhhOE0BLmFmByj1XhKYQ13WXNXJVPrwjde8OaCIgCdSWpT222GNUoOCxl+lFFZpRdbULK/VJOMhHqen6pQxwnkpBzYKJkuHrDBWhz6a0VN1UzuSmfizLXTO/UE7YGUZbG7/g6sIs/yNXwW0wTbmyA93hlTD99JJGRb7zOorFMN4NCp3XGyQmgfWUJV3vurRWffJ0ug/VDx+7IvNsCnw1efhExajTiR37Tcyvt89VSMgLDWsImA7WhCJVEOM2F0TdzXaTpOFBhVpla1+y3Eg7i/cwgOuzfErMFHe3KXMur5IgBHErp0bpvLs2EpYzVIeA2fqzRiIG/l6ULDPzBeTkzNCKGpJP2K3L5RKKzpSfqCpx1HuQDQUMLyt4jygRVyBZ/OSk9aEfh7fiGnIU0QGeZgZtgNjbh0oeQPHg4xJlLLm5KL5dXB/TaufFf2mXdR4cHKmVjxy8l5TSOvftz+uW8ye608NMxCaDxSecVj9ecbcxqbNbQsWtsSliPtCrXJL2efjfCziJxypiIKUDVFvu3+JgZ5elZusM6JAtjprLY6uO9fH0DyT5E0acM5XNHVUicHVWwwfsuHBDs1il89/sFogviL5k7cygeEbpI28QJAx5oeYg=
before_install:
- pip install virtualenv
- virtualenv venv
- source venv/bin/activate
install:
- echo "$LOCAL_POSTGRES_DATABASE_NAME"
- pip install -r requirements.txt
- pip install -r requirements.txt -t lib
- pip install coverage==4.5.1
- pip install python-coveralls
- pip install pycodestyle
before_script:
- psql -c "CREATE DATABASE ${LOCAL_POSTGRES_DATABASE_NAME};" -U postgres
- psql -c "CREATE USER ${LOCAL_POSTGRES_USER} WITH LOGIN PASSWORD '${LOCAL_POSTGRES_PASSWORD}';"
  -U postgres
- psql -c "GRANT ALL PRIVILEGES ON DATABASE ${LOCAL_POSTGRES_DATABASE_NAME} TO ${LOCAL_POSTGRES_USER};"
  -U postgres
- psql -c "ALTER ROLE ${LOCAL_POSTGRES_USER} CREATEDB;" -U postgres
- pycodestyle --exclude=migrations,lib,venv --statistics .
script:
- coverage run --source='.' manage.py test election_data
- coverage report --omit="*venv*","manage.py"
after_script:
- deactivate
deploy:
- provider: azure_web_apps
  verbose: true
  slot: "${AZURE_WA_SLOT_DEVELOPMENT}"
  on: ci-test
- provider: azure_web_apps
  verbose: true
  slot: "${AZURE_WA_SLOT_DEVELOPMENT}"
  on: develop
- provider: azure_web_apps
  verbose: true
  slot: "${AZURE_WA_SLOT_PRODUCTION}"
  on: master
after_success:
- coveralls
notifications:
  slack:
    secure: H4nSy9Mo7vnfR6Se5lvtgp33Q3zTFkPCkxhiSl/bUIdv44KveZ+NRKnxVa6rSj4Hfi29MO9YP4I5Xm8SsYuj3FIB03aJk5RhILuj+dYL+k71Q48/NLENP/x0eWknQaDf95EfG7mpSnKFOeiwZ9pHNHSmfnrnEdqb5Gf9UiaHkFReu9PU3rKuBu/LOhat77Jww6t8BZ7LUDzxa0t6kS07M7ow9eyeONh7V/5NIYYfwQe4sVjfJSgriSojQTREYfSsucKRDGEd7XaaZ2hjtDA7dq3N1/2+RZs2COjHVaGaG1gM1RJZpHGXGYA3xWVRe8hpfBLpkaccj0JisYVElEgz1grnKxs+eCWlt9534ILUi6gYnw9YklakgRUELluzLOx01gsyAfHj2RyZxpac7lb6gHcajXYAoZqH7LDNSUZDjaqScJfVr1raC9y0FwO/0SRMT9I3J5iLiuM48JWBkMh4rvgfg8fF6iXi/j0l408fuYRhwXg/uOCiHKqc+tfHzAqR6gTQuEf5LqwSLPPYNPeJW5SMJyofPofPhehOuGeF2j5bsK90u81xeoax5C2yDQKqvvXXjCiU63FZhTELyIFqPsFXaSjM6QB732Uv+L7Nr2NcZtXzf3b3vShBgTSNGH8K0AbJ6IC2ldQ1jQ+3Cwt/0mKizVIfrEhumD3lwZfvAB4=
